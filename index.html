<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DE-TRUSTED ERP | HCM & BANKING</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&family=Roboto+Mono:wght@400;700&display=swap');
        body { font-family: 'Ubuntu', sans-serif; background: #020617; color: #f8fafc; margin: 0; }
        .sidebar { background: #0f172a; border-right: 1px solid #1e293b; height: 100vh; width: 260px; position: fixed; z-index: 50; }
        .main-content { margin-left: 260px; min-height: 100vh; padding: 40px; }
        .glass-card { background: #1e293b; border: 1px solid #334155; border-radius: 12px; padding: 25px; }
        .input-box { background: #020617; border: 1px solid #475569; color: white; padding: 10px; border-radius: 6px; width: 100%; margin-top: 4px; font-family: 'Roboto Mono', monospace; font-size: 13px; outline: none; }
        .btn-gold { background: #fbbf24; color: #020617; font-weight: 900; padding: 12px; border-radius: 6px; cursor: pointer; border: none; text-transform: uppercase; transition: 0.3s; font-size: 11px; }
        .btn-bank { background: #10b981; color: white; font-weight: 800; padding: 12px; border-radius: 6px; cursor: pointer; font-size: 11px; }
        .mono { font-family: 'Roboto Mono', monospace; }
        .history-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 12px; }
        .history-table th { text-align: left; padding: 12px; border-bottom: 2px solid #334155; color: #94a3b8; }
        .history-table td { padding: 12px; border-bottom: 1px solid #1e293b; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>
        window.onload = function() {
            const e = React.createElement;
            const { useState, useEffect } = React;

            const fmt = (num) => new Intl.NumberFormat('en-GH', { minimumFractionDigits: 2 }).format(num);

            function App() {
                const [isAuth, setIsAuth] = useState(false);
                const [passInput, setPassInput] = useState('');
                const [view, setView] = useState('PAYROLL'); // PAYROLL or EMPLOYEES
                
                // DATA REPOSITORIES
                const [employees, setEmployees] = useState([
                    { name: 'Kofi Mensah', id: 'DT-001', nationalId: 'GHA-123456-7', dept: 'Operations', pos: 'Manager', address: 'Accra, GL-044', phone: '233240000000', bank: 'GCB', account: '1010111222' }
                ]);
                const [history, setHistory] = useState([]);

                // CURRENT PROCESSING
                const [selectedEmp, setSelectedEmp] = useState(null);
                const [basicSalary, setBasicSalary] = useState(0);
                const [bonus, setBonus] = useState(0);
                const [loan, setLoan] = useState(0);

                // LOGIC
                const ssnit = (basicSalary + bonus) * 0.055;
                const calculatePAYE = (inc) => {
                    let tax = 0, rem = inc;
                    const bands = [{a:490,r:0},{a:110,r:0.05},{a:130,r:0.10},{a:3167,r:0.175},{a:16103,r:0.25},{a:Infinity,r:0.30}];
                    for (let b of bands) { if (rem <= 0) break; let c = Math.min(rem, b.a); tax += c * b.r; rem -= c; }
                    return tax;
                };
                const paye = calculatePAYE((basicSalary + bonus) - ssnit);
                const net = (basicSalary + bonus) - ssnit - paye - loan;

                const handleLogin = (v) => { v.preventDefault(); if (passInput === 'SUPER2025') setIsAuth(true); else alert("KEY ERROR"); };

                const processPayment = (type) => {
                    if(!selectedEmp) return alert("Select Staff First");
                    const msg = `Hello ${selectedEmp.name}, your net pay of GHS ${fmt(net)} has been processed to ${selectedEmp.bank} account ${selectedEmp.account}.`;
                    
                    if(type === 'WHATSAPP') {
                        window.open(`https://wa.me/${selectedEmp.phone}?text=${encodeURIComponent(msg)}`);
                    } else if(type === 'BANK') {
                        alert(`BANK INTERFACE INITIALIZED: Sending GHS ${fmt(net)} to ${selectedEmp.bank} for ${selectedEmp.name}`);
                    }
                    
                    setHistory([{ id: Date.now(), name: selectedEmp.name, net: net, date: new Date().toLocaleDateString() }, ...history]);
                };

                if (!isAuth) {
                    return e('div', { className: 'h-screen flex items-center justify-center bg-slate-950' },
                        e('form', { onSubmit: handleLogin, className: 'glass-card w-80 text-center' },
                            e('h1', { className: 'text-2xl font-black mb-4' }, 'DE-TRUSTED ERP'),
                            e('input', { type: 'password', className: 'input-box text-center mb-4', placeholder: 'KEY', value: passInput, onChange: v => setPassInput(v.target.value) }),
                            e('button', { type: 'submit', className: 'btn-gold w-full' }, 'ENTER SYSTEM')
                        )
                    );
                }

                return e('div', { className: 'flex' },
                    e('aside', { className: 'sidebar' },
                        e('div', { className: 'p-8 border-b border-slate-800' }, e('h1', { className: 'text-xl font-black italic text-white' }, 'DE-TRUSTED')),
                        e('nav', { className: 'mt-6 space-y-2' },
                            e('div', { onClick: () => setView('PAYROLL'), className: `nav-link p-4 cursor-pointer text-xs font-bold ${view === 'PAYROLL' ? 'bg-slate-800 text-yellow-500' : 'text-slate-500'}` }, 'ðŸ’³ PAYROLL DESK'),
                            e('div', { onClick: () => setView('EMPLOYEES'), className: `nav-link p-4 cursor-pointer text-xs font-bold ${view === 'EMPLOYEES' ? 'bg-slate-800 text-yellow-500' : 'text-slate-500'}` }, 'ðŸ‘¥ STAFF DATABASE')
                        )
                    ),
                    e('main', { className: 'main-content flex-1' },
                        view === 'PAYROLL' ? e('div', null,
                            e('h2', { className: 'text-3xl font-black mb-10' }, 'Direct Bank Payroll'),
                            e('div', { className: 'grid grid-cols-1 xl:grid-cols-2 gap-8' },
                                e('div', { className: 'glass-card space-y-4' },
                                    e('div', null, 
                                        e('label', {className:'text-[10px] text-slate-500'}, 'SELECT STAFF (AUTO-FILL)'),
                                        e('select', { 
                                            className:'input-box', 
                                            onChange: v => setSelectedEmp(employees.find(emp => emp.name === v.target.value))
                                        }, 
                                            e('option', null, '-- Choose Staff --'),
                                            employees.map(emp => e('option', { key: emp.id, value: emp.name }, emp.name))
                                        )
                                    ),
                                    selectedEmp && e('div', { className: 'grid grid-cols-2 gap-4 bg-slate-900/50 p-4 rounded border border-slate-800 text-[11px]' },
                                        e('div', null, e('p', {className:'text-slate-500'}, 'STAFF ID'), e('p', {className:'font-bold'}, selectedEmp.id)),
                                        e('div', null, e('p', {className:'text-slate-500'}, 'POSITION'), e('p', {className:'font-bold'}, selectedEmp.pos)),
                                        e('div', null, e('p', {className:'text-slate-500'}, 'DEPT'), e('p', {className:'font-bold'}, selectedEmp.dept)),
                                        e('div', null, e('p', {className:'text-slate-500'}, 'GHANA CARD'), e('p', {className:'font-bold'}, selectedEmp.nationalId))
                                    ),
                                    e('div', {className:'grid grid-cols-2 gap-4'},
                                        e('div', null, e('label', {className:'text-[10px] text-slate-500'}, 'BASIC SALARY'), e('input', {type:'number', className:'input-box', value:basicSalary||'', onChange:v=>setBasicSalary(parseFloat(v.target.value)||0)})),
                                        e('div', null, e('label', {className:'text-[10px] text-slate-500'}, 'BONUS'), e('input', {type:'number', className:'input-box', value:bonus||'', onChange:v=>setBonus(parseFloat(v.target.value)||0)}))
                                    ),
                                    e('div', null, e('label', {className:'text-[10px] text-red-400'}, 'LOAN DEDUCTION'), e('input', {type:'number', className:'input-box border-red-900', value:loan||'', onChange:v=>setLoan(parseFloat(v.target.value)||0)})),
                                    e('div', {className:'flex gap-2 pt-4'},
                                        e('button', { className: 'btn-bank flex-1', onClick: () => processPayment('BANK') }, 'SEND TO BANK'),
                                        e('button', { className: 'btn-gold flex-1', onClick: () => processPayment('WHATSAPP') }, 'WHATSAPP PAYSLIP')
                                    )
                                ),
                                e('div', { className: 'glass-card bg-slate-900/40 border-slate-700' },
                                    e('h3', { className: 'text-xs font-bold text-slate-500 mb-6 uppercase' }, 'Payment Summary'),
                                    e('div', { className: 'space-y-4 mono text-sm' },
                                        e('div', { className: 'flex justify-between' }, e('span', null, 'Total Gross'), e('span', null, fmt(basicSalary+bonus))),
                                        e('div', { className: 'flex justify-between text-red-400' }, e('span', null, 'SSNIT + PAYE'), e('span', null, `-${fmt(ssnit+paye)}`)),
                                        e('div', { className: 'flex justify-between text-orange-400' }, e('span', null, 'Loan Recovery'), e('span', null, `-${fmt(loan)}`)),
                                        e('div', { className: 'mt-10 p-6 bg-emerald-500/10 border-2 border-emerald-500/20 rounded-xl text-center' },
                                            e('p', {className:'text-[10px] text-emerald-500 font-bold'}, 'FINAL TRANSFER AMOUNT'),
                                            e('h1', {className:'text-4xl font-black text-emerald-500'}, `GHS ${fmt(net)}`)
                                        )
                                    )
                                )
                            )
                        ) : e('div', null,
                            e('h2', { className: 'text-3xl font-black mb-10' }, 'Staff Directory'),
                            e('div', { className: 'glass-card' },
                                e('p', {className:'text-slate-400 text-xs italic mb-4'}, 'New staff registration form would go here... Showing current database below:'),
                                e('table', { className: 'history-table' },
                                    e('thead', null, e('tr', null, e('th', null, 'NAME'), e('th', null, 'STAFF ID'), e('th', null, 'DEPT'), e('th', null, 'BANK'))),
                                    e('tbody', null, employees.map(emp => e('tr', { key: emp.id },
                                        e('td', {className:'font-bold'}, emp.name),
                                        e('td', null, emp.id),
                                        e('td', null, emp.dept),
                                        e('td', {className:'text-yellow-500'}, emp.bank)
                                    )))
                                )
                            )
                        )
                    )
                );
            }
            ReactDOM.createRoot(document.getElementById('root')).render(e(App));
        };
    </script>
</body>
</html>
