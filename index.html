<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DE-TRUSTED ERP | AI-HR & BIOMETRICS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&family=Roboto+Mono:wght@400;700&display=swap');
        body { font-family: 'Ubuntu', sans-serif; background: #020617; color: #f8fafc; margin: 0; }
        .sidebar { background: #0f172a; border-right: 1px solid #1e293b; height: 100vh; width: 260px; position: fixed; z-index: 50; }
        .main-content { margin-left: 260px; min-height: 100vh; padding: 40px; }
        .glass-card { background: #1e293b; border: 1px solid #334155; border-radius: 12px; padding: 25px; }
        .input-box { background: #020617; border: 1px solid #475569; color: white; padding: 10px; border-radius: 6px; width: 100%; margin-top: 4px; font-family: 'Roboto Mono', monospace; font-size: 13px; outline: none; }
        .btn-gold { background: #fbbf24; color: #020617; font-weight: 900; padding: 12px; border-radius: 6px; cursor: pointer; border: none; text-transform: uppercase; font-size: 11px; transition: 0.3s; }
        .cam-preview { width: 160px; height: 120px; background: #000; border-radius: 8px; border: 2px solid #fbbf24; overflow: hidden; position: relative; }
        .performance-badge { padding: 2px 8px; border-radius: 20px; font-size: 10px; font-weight: bold; text-transform: uppercase; }
        .mono { font-family: 'Roboto Mono', monospace; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>
        window.onload = function() {
            const e = React.createElement;
            const { useState, useRef } = React;

            function App() {
                const [isAuth, setIsAuth] = useState(false);
                const [passInput, setPassInput] = useState('');
                const [view, setView] = useState('PAYROLL');
                const videoRef = useRef(null);

                // DATABASE
                const [employees, setEmployees] = useState([]);
                const [capturedImg, setCapturedImg] = useState(null);
                const [newEmp, setNewEmp] = useState({
                    fName: '', mName: '', lName: '', phone: '', email: '', edu: '', 
                    gps: '', idNum: '', dept: '', pos: '', basic: 0
                });

                // PERFORMANCE & ATTENDANCE
                const [attendanceDays, setAttendanceDays] = useState(22); // Target 22 days
                const [kpiScore, setKpiScore] = useState(100); // Percentage

                // CAMERA FUNCTIONS
                const startCam = async () => {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    videoRef.current.srcObject = stream;
                };

                const takeSnap = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = 160; canvas.height = 120;
                    canvas.getContext('2d').drawImage(videoRef.current, 0, 0);
                    setCapturedImg(canvas.toDataURL('image/png'));
                };

                const addEmployee = () => {
                    const staffId = `DT-${new Date().getFullYear()}-${Math.floor(1000 + Math.random()*9000)}`;
                    const empObj = { ...newEmp, staffId, photo: capturedImg, id: Date.now(), attendance: 100, performance: 100 };
                    setEmployees([...employees, empObj]);
                    setCapturedImg(null);
                    alert("Staff Registered with Biometric Photo!");
                };

                if (!isAuth) {
                    return e('div', { className: 'h-screen flex items-center justify-center bg-slate-950' },
                        e('form', { onSubmit: (v) => { v.preventDefault(); if(passInput==='SUPER2025') setIsAuth(true); else alert("KEY ERROR"); }, className: 'glass-card w-80 text-center' },
                            e('h1', { className: 'text-2xl font-black mb-6' }, 'DE-TRUSTED ERP'),
                            e('input', { type: 'password', className: 'input-box text-center mb-4', placeholder: 'MASTER KEY', value: passInput, onChange: v => setPassInput(v.target.value) }),
                            e('button', { type: 'submit', className: 'btn-gold w-full' }, 'UNFOLD SYSTEM')
                        )
                    );
                }

                return e('div', { className: 'flex' },
                    e('aside', { className: 'sidebar' },
                        e('div', { className: 'p-8 border-b border-slate-800' }, e('h1', { className: 'text-xl font-black italic' }, 'DE-TRUSTED')),
                        e('nav', { className: 'mt-6' },
                            e('div', { onClick: () => setView('PAYROLL'), className: `p-4 cursor-pointer text-xs font-bold ${view === 'PAYROLL' ? 'text-yellow-500 bg-slate-800' : 'text-slate-500'}` }, 'ðŸ“‰ PERFORMANCE PAYROLL'),
                            e('div', { onClick: () => setView('ADD_EMP'), className: `p-4 cursor-pointer text-xs font-bold ${view === 'ADD_EMP' ? 'text-yellow-500 bg-slate-800' : 'text-slate-500'}` }, 'ðŸ“¸ BIOMETRIC ONBOARDING')
                        )
                    ),
                    e('main', { className: 'main-content flex-1' },
                        
                        view === 'ADD_EMP' && e('div', { className: 'max-w-4xl' },
                            e('h2', { className: 'text-3xl font-black mb-8' }, 'Biometric Staff Entry'),
                            e('div', { className: 'glass-card space-y-6' },
                                e('div', { className: 'flex gap-8 items-start' },
                                    e('div', { className: 'space-y-2' },
                                        e('div', { className: 'cam-preview' }, 
                                            capturedImg ? e('img', {src: capturedImg}) : e('video', {ref: videoRef, autoPlay: true, className:'w-full h-full object-cover'})
                                        ),
                                        e('button', { onClick: startCam, className:'text-[10px] bg-slate-800 px-2 py-1 rounded w-full' }, 'Start Cam'),
                                        e('button', { onClick: takeSnap, className:'text-[10px] bg-emerald-600 px-2 py-1 rounded w-full font-bold' }, 'Capture Photo')
                                    ),
                                    e('div', { className: 'flex-1 grid grid-cols-2 gap-4' },
                                        e('input', {className:'input-box', placeholder:'First Name', onChange:v=>setNewEmp({...newEmp, fName:v.target.value})}),
                                        e('input', {className:'input-box', placeholder:'Last Name', onChange:v=>setNewEmp({...newEmp, lName:v.target.value})}),
                                        e('input', {className:'input-box', placeholder:'Email', onChange:v=>setNewEmp({...newEmp, email:v.target.value})}),
                                        e('input', {className:'input-box', placeholder:'Dept', onChange:v=>setNewEmp({...newEmp, dept:v.target.value})}),
                                        e('input', {type:'number', className:'input-box text-yellow-500', placeholder:'Basic Salary (GHS)', onChange:v=>setNewEmp({...newEmp, basic:parseFloat(v.target.value)||0})})
                                    )
                                ),
                                e('button', { className: 'btn-gold w-full', onClick: addEmployee }, 'Finalize Registration')
                            )
                        ),

                        view === 'PAYROLL' && e('div', null,
                            e('h2', { className: 'text-3xl font-black mb-8' }, 'Performance-Linked Payroll'),
                            e('div', { className: 'grid grid-cols-1 xl:grid-cols-2 gap-8' },
                                e('div', { className: 'glass-card space-y-6' },
                                    e('select', { className: 'input-box', onChange: v => alert("Linked to Performance Metrics") },
                                        e('option', null, '-- Choose Employee --'),
                                        employees.map(emp => e('option', {key:emp.id}, `${emp.fName} ${emp.lName}`))
                                    ),
                                    e('div', {className:'grid grid-cols-2 gap-4'},
                                        e('div', null, 
                                            e('label', {className:'text-[10px] text-slate-500'}, 'ATTENDANCE (Days out of 22)'),
                                            e('input', {type:'number', className:'input-box', value:attendanceDays, onChange:v=>setAttendanceDays(v.target.value)})
                                        ),
                                        e('div', null, 
                                            e('label', {className:'text-[10px] text-slate-500'}, 'KPI SCORE (%)'),
                                            e('input', {type:'number', className:'input-box', value:kpiScore, onChange:v=>setKpiScore(v.target.value)})
                                        )
                                    )
                                ),
                                e('div', { className: 'glass-card bg-slate-900/40 border-yellow-500/20' },
                                    e('h3', { className: 'text-xs font-bold text-slate-500 mb-6 uppercase' }, 'AI Payout Analysis'),
                                    e('div', { className: 'space-y-4 mono text-sm' },
                                        e('div', {className:'flex justify-between'}, e('span', null, 'Attendance Ratio'), e('span', null, `${((attendanceDays/22)*100).toFixed(1)}%`)),
                                        e('div', {className:'flex justify-between'}, e('span', null, 'KPI Performance'), e('span', {className: kpiScore >= 80 ? 'text-emerald-500' : 'text-red-500'}, `${kpiScore}%`)),
                                        e('div', {className:'pt-6 border-t border-slate-700 text-center'},
                                            e('p', {className:'text-[10px] text-slate-500'}, 'RECOMMENDED PAYOUT ADJUSTMENT'),
                                            e('h1', {className:'text-4xl font-black text-yellow-500'}, `${( (attendanceDays/22) * (kpiScore/100) * 100 ).toFixed(1)}%`)
                                        )
                                    )
                                )
                            )
                        )
                    )
                );
            }
            ReactDOM.createRoot(document.getElementById('root')).render(e(App));
        };
    </script>
</body>
</html>
